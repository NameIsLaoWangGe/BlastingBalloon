{
  "code": "import { Clicks } from \"../Template/Clicks\";\r\nimport { Animation } from \"../Template/Animation\";\r\nexport default class Beetle extends Laya.Script {\r\n    constructor() {\r\n        super();\r\n        this.remainTime = 0;\r\n    }\r\n    onEnable() {\r\n        this.self = this.owner;\r\n        this.self['Beetle'] = this;\r\n        this.gameControl = this.self.scene['GameControl'];\r\n        this.BalloonVessel = this.gameControl.BalloonVessel;\r\n        this.skeleton = this.self.getChildByName('skeleton');\r\n        this.createBoneAni();\r\n        this.birthLocation();\r\n        this.speed = 10;\r\n        this.clicksOnBtn();\r\n    }\r\n    birthLocation() {\r\n        let direction = Math.floor(Math.random() * 2);\r\n        if (direction === 1) {\r\n            this.self.x = this.BalloonVessel.x + this.BalloonVessel.width / 2 + 800;\r\n        }\r\n        else {\r\n            this.self.x = this.BalloonVessel.x + this.BalloonVessel.width / 2 - 800;\r\n        }\r\n        this.self.y = this.BalloonVessel.y + (Math.random() * 1) * this.BalloonVessel.height;\r\n    }\r\n    movePos() {\r\n        let shrink = 80;\r\n        this.moveX = this.BalloonVessel.x - this.BalloonVessel.width / 2 + 50 + (this.BalloonVessel.width - shrink * 2) * (Math.random() * 1);\r\n        this.moveY = this.BalloonVessel.y + shrink + (this.BalloonVessel.height - shrink * 2) * (Math.random() * 1);\r\n    }\r\n    createBoneAni() {\r\n        this.templet = new Laya.Templet();\r\n        this.templet.on(Laya.Event.COMPLETE, this, this.parseComplete);\r\n        this.templet.on(Laya.Event.ERROR, this, this.onError);\r\n        this.templet.loadAni(\"Skeleton/beetle_01.sk\");\r\n    }\r\n    onError() {\r\n        console.log('骨骼动画加载错误！');\r\n    }\r\n    parseComplete() {\r\n        this.moveSwitch = true;\r\n        this.posSwitch = true;\r\n        this.playSkeletonAni(1, 'move');\r\n    }\r\n    playSkeletonAni(speed, type) {\r\n        this.skeleton.play(type, true);\r\n        this.skeleton.rotation = 0;\r\n        this.skeleton.playbackRate(speed);\r\n    }\r\n    clicksOnBtn() {\r\n        Clicks.beetleScale = this.self.scaleX;\r\n        Clicks.clicksOn('beetle', '音效/按钮点击.mp3', this.self, this, null, null, this.up, null);\r\n    }\r\n    clicksOffBtn() {\r\n        Clicks.clicksOff('beetle', this.self, this, null, null, this.up, null);\r\n    }\r\n    up(event) {\r\n        this.clicksOffBtn();\r\n        event.currentTarget.scale(Clicks.beetleScale, Clicks.beetleScale);\r\n        Animation.leftRight_Shake(this.self, 20, 30, 50, f => {\r\n            this.gameControl.createGameOver('defeated');\r\n        });\r\n    }\r\n    moveRule() {\r\n        let point = new Laya.Point(this.moveX - this.self.x, this.moveY - this.self.y);\r\n        point.normalize();\r\n        this.self.x += point.x * this.speed;\r\n        this.self.y += point.y * this.speed;\r\n        let differenceX = Math.abs(this.self.x - this.moveX);\r\n        let differenceY = Math.abs(this.self.y - this.moveY);\r\n        if (differenceX < 10 && differenceY < 10) {\r\n            this.playSkeletonAni(1, 'stand');\r\n            this.moveSwitch = false;\r\n            this.remainTime = 0;\r\n        }\r\n    }\r\n    onUpdate() {\r\n        if (this.moveSwitch) {\r\n            if (this.posSwitch) {\r\n                this.movePos();\r\n                this.playSkeletonAni(1, 'move');\r\n                this.posSwitch = false;\r\n            }\r\n            else {\r\n                this.moveRule();\r\n            }\r\n        }\r\n        else {\r\n            this.remainTime++;\r\n            if (this.remainTime > 200) {\r\n                this.moveSwitch = true;\r\n                this.posSwitch = true;\r\n            }\r\n        }\r\n    }\r\n    onDisable() {\r\n    }\r\n}\r\n",
  "references": [
    "F:/Work/Game/03_BlastingBalloon/project/BlastingBalloon/src/Script/Template/Clicks.ts",
    "F:/Work/Game/03_BlastingBalloon/project/BlastingBalloon/src/Script/Template/Animation.ts"
  ]
}
