{
  "code": "export var WXDataManager;\r\n(function (WXDataManager) {\r\n    WXDataManager.wx = Laya.Browser.window.wx;\r\n    function WXcheckSession() {\r\n        if (Laya.Browser.onMiniGame) {\r\n            WXDataManager.wx.checkSession({\r\n                success() {\r\n                    console.log('已经登录过了！');\r\n                },\r\n                fail() {\r\n                    WXLogin();\r\n                    console.log('重新登录');\r\n                }\r\n            });\r\n        }\r\n    }\r\n    WXDataManager.WXcheckSession = WXcheckSession;\r\n    function WXLogin() {\r\n        if (Laya.Browser.onMiniGame) {\r\n            WXDataManager.wx.login({\r\n                success: function (res) {\r\n                    if (res.code) {\r\n                        console.log(\"登录成功，获取到code\", res.code);\r\n                    }\r\n                    var button = WXDataManager.wx.createUserInfoButton({\r\n                        type: 'text',\r\n                        text: '开始游戏',\r\n                        style: {\r\n                            left: WXDataManager.wx.getSystemInfoSync().screenWidth / 2 - 60,\r\n                            bottom: WXDataManager.wx.getSystemInfoSync().screenHeight / 2 - 60,\r\n                            width: 120,\r\n                            height: 40,\r\n                            lineHeight: 40,\r\n                            backgroundColor: '#fb94a9',\r\n                            color: '#ffffff',\r\n                            textAlign: 'center',\r\n                            fontSize: 16,\r\n                            borderRadius: 20\r\n                        }\r\n                    });\r\n                    button.show();\r\n                    button.onTap((res) => {\r\n                        console.log(res);\r\n                        if (res.errMsg === \"getUserInfo:ok\") {\r\n                            console.log(\"已经授权\");\r\n                            button.destroy();\r\n                            onRegisterUser(res.userInfo);\r\n                        }\r\n                        else {\r\n                            console.log(\"没有授权\");\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        }\r\n    }\r\n    WXDataManager.WXLogin = WXLogin;\r\n    function onRegisterUser(_userinfo) {\r\n        WXDataManager.wx.cloud.init({\r\n            env: 'release-lwg'\r\n        });\r\n        WXDataManager.wx.cloud.callFunction({\r\n            name: \"login\",\r\n            data: {\r\n                userinfo: _userinfo,\r\n            },\r\n            success(res) {\r\n                console.log(\"登录成功回调\", res);\r\n                WXDataManager.WXuserinfo = res.result.event.userinfo;\r\n                console.log(WXDataManager.WXuserinfo);\r\n            },\r\n            fail: console.error()\r\n        });\r\n    }\r\n    WXDataManager.onRegisterUser = onRegisterUser;\r\n})(WXDataManager || (WXDataManager = {}));\r\nexport default WXDataManager;\r\n",
  "references": [
    "F:/Work/Game/03_BlastingBalloon/project/BlastingBalloon/src/Script/Login.ts"
  ]
}
