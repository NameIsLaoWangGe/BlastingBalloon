{
  "code": "import { Animation } from \"../Template/Animation\";\r\nimport { Clicks } from \"../Template/Clicks\";\r\nimport { PalyAudio } from \"../Template/PlayAudio\";\r\nimport { Adaptive } from \"../Template/Adaptive\";\r\nimport { Advertising } from \"../Template/Advertising\";\r\nimport { Enum } from \"../Template/Enum\";\r\nexport default class GameOver extends Laya.Script {\r\n    constructor() { super(); }\r\n    onEnable() {\r\n        this.self = this.owner;\r\n        this.self['GameOver'] = this;\r\n        this.gameControl = this.self.scene['GameControl'];\r\n        this.Levels = this.gameControl.Levels;\r\n        this.line = this.gameControl.line;\r\n        this.logoSwitch = false;\r\n        this.logoChange = 'appear';\r\n        Adaptive.interface_Center(this.self);\r\n        Adaptive.background_Center(this.background, this.self);\r\n    }\r\n    gameOverType(type) {\r\n        if (type === 'victory') {\r\n            this.btn_again.loadImage('UI/下一关按钮.png');\r\n            this.settlementType = 'victory';\r\n            this.logo.loadImage('UI/闯关成功logo.png');\r\n            PalyAudio.playMusic(Enum.AudioName.victory, 1, 0);\r\n        }\r\n        else if (type === 'defeated') {\r\n            this.btn_again.loadImage('UI/重来按钮.png');\r\n            this.settlementType = 'defeated';\r\n            this.logo.loadImage('UI/闯关失败logo.png');\r\n            PalyAudio.playMusic(Enum.AudioName.defeated, 1, 0);\r\n        }\r\n        let score = this.scoreNode.getChildByName('score');\r\n        score.value = this.Levels.value;\r\n        this.appaer();\r\n    }\r\n    appaer() {\r\n        let scale = 1.3;\r\n        let time1 = 250;\r\n        let time2 = 60;\r\n        let delayed = 200;\r\n        Animation.fade_out(this.background, 0, 0.8, 200, 0, null);\r\n        Animation.bombs_Appear(this.scoreNode, 0, 1, scale, Math.floor(Math.random() * 2) === 1 ? 5 : -5, time1, time2, delayed * 0, null);\r\n        Animation.bombs_Appear(this.logo, 0, 1, scale, Math.floor(Math.random() * 2) === 1 ? 5 : -5, time1, time2, delayed * 1, null);\r\n        Animation.bombs_Appear(this.btn_again, 0, 1, scale, Math.floor(Math.random() * 2) === 1 ? 5 : -5, time1, time2, delayed * 2, null);\r\n        Animation.bombs_Appear(this.btn_return, 0, 1, scale, Math.floor(Math.random() * 2) === 1 ? 5 : -5, time1, time2, delayed * 3, func => {\r\n            this.appearFunc();\r\n        });\r\n    }\r\n    appearFunc() {\r\n        this.clicksOnBtn();\r\n        if (Laya.Browser.onMiniGame) {\r\n            Advertising.bannarAd_01.show()\r\n                .then(() => console.log('banner 广告显示'));\r\n        }\r\n    }\r\n    vanish(type) {\r\n        let time = 250;\r\n        let delayed = 100;\r\n        Animation.fade_out(this.background, 0.8, 0, time, delayed * 4, null);\r\n        Animation.bombs_Vanish(this.scoreNode, 0, 0, Math.floor(Math.random() * 2) === 1 ? 5 : -5, time, delayed * 1, null);\r\n        Animation.bombs_Vanish(this.logo, 0, 0, Math.floor(Math.random() * 2) === 1 ? 5 : -5, time, delayed * 2, null);\r\n        Animation.bombs_Vanish(this.btn_again, 0, 0, Math.floor(Math.random() * 2) === 1 ? 5 : -5, time, delayed * 3, null);\r\n        Animation.bombs_Vanish(this.btn_return, 0, 0, Math.floor(Math.random() * 2) === 1 ? 5 : -5, time, delayed * 4, f => {\r\n            this.vanishFunc(type);\r\n        });\r\n    }\r\n    vanishFunc(type) {\r\n        if (Laya.Browser.onMiniGame) {\r\n            Advertising.bannarAd_01.hide();\r\n        }\r\n        if (type === 'return') {\r\n            this.gameControl.leaveAnimation();\r\n        }\r\n        else if ('again') {\r\n            if (this.settlementType === 'victory') {\r\n                this.gameControl.moveToNextLevel();\r\n            }\r\n            else if (this.settlementType === 'defeated') {\r\n                this.gameControl.againCurrentlevel();\r\n            }\r\n        }\r\n        this.self.removeSelf();\r\n    }\r\n    clicksOnBtn() {\r\n        Clicks.clicksOn('largen', '音效/按钮点击.mp3', this.btn_again, this, null, null, this.up, null);\r\n        Clicks.clicksOn('largen', '音效/按钮点击.mp3', this.btn_return, this, null, null, this.up, null);\r\n    }\r\n    clicksOffBtn() {\r\n        Clicks.clicksOff('largen', this.btn_again, this, null, null, this.up, null);\r\n        Clicks.clicksOff('largen', this.btn_return, this, null, null, this.up, null);\r\n    }\r\n    up(event) {\r\n        event.currentTarget.scale(1, 1);\r\n        this.clicksOffBtn();\r\n        if (event.currentTarget.name === 'btn_again') {\r\n            this.vanish('again');\r\n        }\r\n        else if (event.currentTarget.name === 'btn_return') {\r\n            this.vanish('return');\r\n        }\r\n    }\r\n    onUpdate() {\r\n        if (this.logoSwitch) {\r\n            if (this.logoChange === 'appear') {\r\n                this.logo.alpha -= 0.01;\r\n                if (this.logo.alpha < 0.3) {\r\n                    this.logoChange = 'vanish';\r\n                }\r\n            }\r\n            else if (this.logoChange === 'vanish') {\r\n                this.logo.alpha += 0.01;\r\n                if (this.logo.alpha >= 1) {\r\n                    this.logoChange = 'appear';\r\n                }\r\n            }\r\n        }\r\n    }\r\n    onDisable() {\r\n    }\r\n}\r\n",
  "references": [
    "F:/Work/Game/03_BlastingBalloon/project/BlastingBalloon/src/Script/Template/Animation.ts",
    "F:/Work/Game/03_BlastingBalloon/project/BlastingBalloon/src/Script/Template/Clicks.ts",
    "F:/Work/Game/03_BlastingBalloon/project/BlastingBalloon/src/Script/Template/PlayAudio.ts",
    "F:/Work/Game/03_BlastingBalloon/project/BlastingBalloon/src/Script/Template/Adaptive.ts",
    "F:/Work/Game/03_BlastingBalloon/project/BlastingBalloon/src/Script/Template/Advertising.ts",
    "F:/Work/Game/03_BlastingBalloon/project/BlastingBalloon/src/Script/Template/Enum.ts"
  ]
}
