!function(){"use strict";var PalyAudio,Enum,Animation,Clicks,WXDataManager,SkTemplete,Data,Tools,Adaptive,Advertising;!function(PalyAudio){PalyAudio.playSound=function(url,number){Laya.SoundManager.playSound(url,number,Laya.Handler.create(this,function(){}))},PalyAudio.playMusic=function(url,number,deley){Laya.SoundManager.playMusic(url,number,Laya.Handler.create(this,function(){}),deley)}}(PalyAudio||(PalyAudio={})),function(Enum){let ColorSkin,BalloonName,IconSkin_01,IconSkin_02,Explode_Yellowish,Explode_Pink,Explode_Yellow,Explode_Cyan,Explode_Purple,Sk_Ballon_Type,AudioName;!function(ColorSkin){ColorSkin[ColorSkin["UI/balloon_淡黄.png"]=0]="UI/balloon_淡黄.png",ColorSkin[ColorSkin["UI/balloon_粉色.png"]=1]="UI/balloon_粉色.png",ColorSkin[ColorSkin["UI/balloon_黄色.png"]=2]="UI/balloon_黄色.png",ColorSkin[ColorSkin["UI/balloon_青色.png"]=3]="UI/balloon_青色.png",ColorSkin[ColorSkin["UI/balloon_紫色.png"]=4]="UI/balloon_紫色.png"}(ColorSkin=Enum.ColorSkin||(Enum.ColorSkin={})),function(BalloonName){BalloonName[BalloonName.yellowish=0]="yellowish",BalloonName[BalloonName.pink=1]="pink",BalloonName[BalloonName.yellow=2]="yellow",BalloonName[BalloonName.cyan=3]="cyan",BalloonName[BalloonName.purple=4]="purple"}(BalloonName=Enum.BalloonName||(Enum.BalloonName={})),function(IconSkin_01){IconSkin_01[IconSkin_01["UI/icon_淡黄.png"]=0]="UI/icon_淡黄.png",IconSkin_01[IconSkin_01["UI/icon_粉色.png"]=1]="UI/icon_粉色.png",IconSkin_01[IconSkin_01["UI/icon_黄色.png"]=2]="UI/icon_黄色.png",IconSkin_01[IconSkin_01["UI/icon_青色.png"]=3]="UI/icon_青色.png",IconSkin_01[IconSkin_01["UI/icon_紫色.png"]=4]="UI/icon_紫色.png"}(IconSkin_01=Enum.IconSkin_01||(Enum.IconSkin_01={})),function(IconSkin_02){IconSkin_02[IconSkin_02["UI/icon_淡黄_pitch.png"]=0]="UI/icon_淡黄_pitch.png",IconSkin_02[IconSkin_02["UI/icon_粉色_pitch.png"]=1]="UI/icon_粉色_pitch.png",IconSkin_02[IconSkin_02["UI/icon_黄色_pitch.png"]=2]="UI/icon_黄色_pitch.png",IconSkin_02[IconSkin_02["UI/icon_青色_pitch.png"]=3]="UI/icon_青色_pitch.png",IconSkin_02[IconSkin_02["UI/icon_紫色_pitch.png"]=4]="UI/icon_紫色_pitch.png"}(IconSkin_02=Enum.IconSkin_02||(Enum.IconSkin_02={})),function(Explode_Yellowish){Explode_Yellowish[Explode_Yellowish["特效/effect_淡黄1.png"]=0]="特效/effect_淡黄1.png",Explode_Yellowish[Explode_Yellowish["特效/effect_淡黄2.png"]=1]="特效/effect_淡黄2.png",Explode_Yellowish[Explode_Yellowish["特效/effect_淡黄3.png"]=2]="特效/effect_淡黄3.png",Explode_Yellowish[Explode_Yellowish["特效/effect_淡黄4.png"]=3]="特效/effect_淡黄4.png"}(Explode_Yellowish=Enum.Explode_Yellowish||(Enum.Explode_Yellowish={})),function(Explode_Pink){Explode_Pink[Explode_Pink["特效/effect_粉色1.png"]=0]="特效/effect_粉色1.png",Explode_Pink[Explode_Pink["特效/effect_粉色2.png"]=1]="特效/effect_粉色2.png",Explode_Pink[Explode_Pink["特效/effect_粉色3.png"]=2]="特效/effect_粉色3.png",Explode_Pink[Explode_Pink["特效/effect_粉色4.png"]=3]="特效/effect_粉色4.png"}(Explode_Pink=Enum.Explode_Pink||(Enum.Explode_Pink={})),function(Explode_Yellow){Explode_Yellow[Explode_Yellow["特效/effect_黄色1.png"]=0]="特效/effect_黄色1.png",Explode_Yellow[Explode_Yellow["特效/effect_黄色2.png"]=1]="特效/effect_黄色2.png",Explode_Yellow[Explode_Yellow["特效/effect_黄色3.png"]=2]="特效/effect_黄色3.png",Explode_Yellow[Explode_Yellow["特效/effect_黄色4.png"]=3]="特效/effect_黄色4.png"}(Explode_Yellow=Enum.Explode_Yellow||(Enum.Explode_Yellow={})),function(Explode_Cyan){Explode_Cyan[Explode_Cyan["特效/effect_青色1.png"]=0]="特效/effect_青色1.png",Explode_Cyan[Explode_Cyan["特效/effect_青色2.png"]=1]="特效/effect_青色2.png",Explode_Cyan[Explode_Cyan["特效/effect_青色3.png"]=2]="特效/effect_青色3.png",Explode_Cyan[Explode_Cyan["特效/effect_青色4.png"]=3]="特效/effect_青色4.png"}(Explode_Cyan=Enum.Explode_Cyan||(Enum.Explode_Cyan={})),function(Explode_Purple){Explode_Purple[Explode_Purple["特效/effect_紫色1.png"]=0]="特效/effect_紫色1.png",Explode_Purple[Explode_Purple["特效/effect_紫色2.png"]=1]="特效/effect_紫色2.png",Explode_Purple[Explode_Purple["特效/effect_紫色3.png"]=2]="特效/effect_紫色3.png",Explode_Purple[Explode_Purple["特效/effect_紫色4.png"]=3]="特效/effect_紫色4.png"}(Explode_Purple=Enum.Explode_Purple||(Enum.Explode_Purple={})),function(Sk_Ballon_Type){Sk_Ballon_Type.death="death",Sk_Ballon_Type.error="error",Sk_Ballon_Type.disdain="disdain",Sk_Ballon_Type.static="static",Sk_Ballon_Type.scale="scale"}(Sk_Ballon_Type=Enum.Sk_Ballon_Type||(Enum.Sk_Ballon_Type={})),function(AudioName){AudioName.button="音效/按钮点击.mp3",AudioName.bgm="音效/背景音乐.mp3",AudioName.victory="音效/胜利.mp3",AudioName.defeated="音效/失败.mp3",AudioName.balloonRight="音效/气球点击正确.mp3",AudioName.balloonError="音效/气球点击错误.mp3",AudioName.balloonPopup="音效/气球弹出.mp3",AudioName.beetle="音效/点击甲虫.mp3",AudioName.beetleMove="音效/甲虫溜走.mp3",AudioName.commonPopup="音效/通用弹出.mp3",AudioName.commonVanish="音效/通用消失.mp3"}(AudioName=Enum.AudioName||(Enum.AudioName={}))}(Enum||(Enum={})),function(Animation){Animation.upDown_Rotate=function(node,time,func){Laya.Tween.to(node,{scaleY:0},time,null,Laya.Handler.create(this,function(){Laya.Tween.to(node,{scaleY:1},time,null,Laya.Handler.create(this,function(){Laya.Tween.to(node,{scaleY:0},time,null,Laya.Handler.create(this,function(){Laya.Tween.to(node,{scaleY:1},time,null,Laya.Handler.create(this,function(){null!==func&&func()}),0)}),0)}),0)}),0)},Animation.leftRight_Rotate=function(node,time,func){Laya.Tween.to(node,{scaleX:0},time,null,Laya.Handler.create(this,function(){Laya.Tween.to(node,{scaleX:1},time,null,Laya.Handler.create(this,function(){Laya.Tween.to(node,{scaleX:0},time,null,Laya.Handler.create(this,function(){Laya.Tween.to(node,{scaleX:1},time,null,Laya.Handler.create(this,function(){}),0),null!==func&&func()}),0)}),0)}),0)},Animation.leftRight_Shake=function(node,range,time,delayed,func){Laya.Tween.to(node,{x:node.x-range},time,null,Laya.Handler.create(this,function(){Laya.Tween.to(node,{x:node.x+2*range},time,null,Laya.Handler.create(this,function(){Laya.Tween.to(node,{x:node.x-range},time,null,Laya.Handler.create(this,function(){null!==func&&func()}))}))}),delayed)},Animation.upDwon_Shake=function(node,time,range,func){Laya.Tween.to(node,{y:node.y+range},time,null,Laya.Handler.create(this,function(){Laya.Tween.to(node,{y:node.y-2*range},time,null,Laya.Handler.create(this,function(){Laya.Tween.to(node,{y:node.y+range},time,null,Laya.Handler.create(this,function(){null!==func&&func()}))}))}))},Animation.fade_out=function(node,alpha1,alpha2,time,delayed,func){node.alpha=alpha1,Laya.Tween.to(node,{alpha:alpha2},time,null,Laya.Handler.create(this,function(){null!==func&&func()}),delayed)},Animation.fade_out_Move=function(node,time,range,x,y,delayed,func){Laya.Tween.to(node,{alpha:range,x:x,y:y},time,null,Laya.Handler.create(this,function(){null!==func&&func()}),delayed)},Animation.drop=function(node,targetY,rotation,time,delayed,func){Laya.Tween.to(node,{y:targetY,rotation:rotation},time,Laya.Ease.expoIn,Laya.Handler.create(this,function(){null!==func&&func()}),delayed)},Animation.drop_excursion=function(node,targetY,targetX,rotation,time,delayed,func){Laya.Tween.to(node,{x:node.x+targetX,y:node.y+1*targetY/6},time,Laya.Ease.expoIn,Laya.Handler.create(this,function(){Laya.Tween.to(node,{x:node.x+targetX+50,y:targetY,rotation:rotation},time,null,Laya.Handler.create(this,function(){null!==func&&func()}),0)}),delayed)},Animation.go_up=function(node,initialY,initialR,targetY,time,delayed,func){node.y=initialY,node.rotation=initialR,Laya.Tween.to(node,{y:targetY,rotation:0},time,Laya.Ease.cubicOut,Laya.Handler.create(this,function(){null!==func&&func()}),delayed)},Animation.cardRotateX_TowFace=function(node,arr,func1,time,delayed,func2){Laya.Tween.to(node,{scaleX:0},time,null,Laya.Handler.create(this,function(){for(let i=0;i<arr.length;i++){let child=node.getChildByName(arr[i]);null!==child&&(child.alpha=0)}null!==func1&&func1(),Laya.Tween.to(node,{scaleX:1},time,null,Laya.Handler.create(this,function(){Laya.Tween.to(node,{scaleX:0},time,null,Laya.Handler.create(this,function(){Laya.Tween.to(node,{scaleX:1},1*time/2,null,Laya.Handler.create(this,function(){for(let i=0;i<arr.length;i++){let child=node.getChildByName(arr[i]);null!==child&&(child.alpha=1)}null!==func2&&func2()}),0)}),0)}),0)}),delayed)},Animation.cardRotateX_OneFace=function(node,func1,time,delayed,func2){Laya.Tween.to(node,{scaleX:0},time,null,Laya.Handler.create(this,function(){null!==func1&&func1(),Laya.Tween.to(node,{scaleX:1},time,null,Laya.Handler.create(this,function(){null!==func2&&func2()}),0)}),delayed)},Animation.cardRotateY_TowFace=function(node,arr,func1,time,delayed,func2){Laya.Tween.to(node,{scaleY:0},time,null,Laya.Handler.create(this,function(){for(let i=0;i<arr.length;i++){let child=node.getChildByName(arr[i]);null!==child&&(child.alpha=0)}null!==func1&&func1(),Laya.Tween.to(node,{scaleY:1},time,null,Laya.Handler.create(this,function(){Laya.Tween.to(node,{scaleY:0},time,null,Laya.Handler.create(this,function(){Laya.Tween.to(node,{scaleY:1},1*time/2,null,Laya.Handler.create(this,function(){for(let i=0;i<arr.length;i++){let child=node.getChildByName(arr[i]);null!==child&&(child.alpha=1)}null!==func2&&func2()}),0)}),0)}),0)}),delayed)},Animation.cardRotateY_OneFace=function(node,func1,time,delayed,func2){Laya.Tween.to(node,{scaleY:0},time,null,Laya.Handler.create(this,function(){null!==func1&&func1(),Laya.Tween.to(node,{scaleY:1},time,null,Laya.Handler.create(this,function(){null!==func2&&func2()}),0)}),delayed)},Animation.move_changeRotate=function(node,targetX,targetY,per,rotation_pe,time,func){let targetPerX=targetX*per+node.x*(1-per),targetPerY=targetY*per+node.y*(1-per);Laya.Tween.to(node,{x:targetPerX,y:targetPerY,rotation:45},time,null,Laya.Handler.create(this,function(){Laya.Tween.to(node,{x:targetX,y:targetY,rotation:0},time,null,Laya.Handler.create(this,function(){null!==func&&func()}),0)}),0)},Animation.bombs_Appear=function(node,firstAlpha,firstScale,scale1,rotation,time1,time2,delayed,audioType,func){node.scale(0,0),node.alpha=firstAlpha,Laya.Tween.to(node,{scaleX:scale1,scaleY:scale1,alpha:1,rotation:rotation},time1,Laya.Ease.cubicInOut,Laya.Handler.create(this,function(){Laya.Tween.to(node,{scaleX:firstScale,scaleY:firstScale,rotation:0},time2,null,Laya.Handler.create(this,function(){switch(audioType){case"balloon":PalyAudio.playSound(Enum.AudioName.balloonPopup,1);break;case"common":PalyAudio.playSound(Enum.AudioName.commonPopup,1)}Laya.Tween.to(node,{scaleX:firstScale+.2*(scale1-firstScale),scaleY:firstScale+.2*(scale1-firstScale),rotation:0},time2,null,Laya.Handler.create(this,function(){Laya.Tween.to(node,{scaleX:firstScale,scaleY:firstScale,rotation:0},time2,null,Laya.Handler.create(this,function(){null!==func&&func()}),0)}),0)}),0)}),delayed)},Animation.bombs_Vanish=function(node,scale,alpha,rotation,time,delayed,func){Laya.Tween.to(node,{scaleX:scale,scaleY:scale,alpha:alpha,rotation:rotation},time,Laya.Ease.cubicOut,Laya.Handler.create(this,function(){PalyAudio.playSound(Enum.AudioName.commonVanish,1),null!==func&&func()}),delayed)},Animation.swell_shrink=function(node,firstScale,scale1,time,delayed,func){Laya.Tween.to(node,{scaleX:scale1,scaleY:scale1,alpha:1},time,Laya.Ease.cubicInOut,Laya.Handler.create(this,function(){Laya.Tween.to(node,{scaleX:firstScale,scaleY:firstScale,rotation:0},time,null,Laya.Handler.create(this,function(){Laya.Tween.to(node,{scaleX:firstScale+.5*(scale1-firstScale),scaleY:firstScale+.5*(scale1-firstScale),rotation:0},.5*time,null,Laya.Handler.create(this,function(){Laya.Tween.to(node,{scaleX:firstScale,scaleY:firstScale,rotation:0},time,null,Laya.Handler.create(this,function(){null!==func&&func()}),0)}),0)}),0)}),delayed)},Animation.simple_Move=function(node,firstX,firstY,targetX,targetY,time,delayed,func){node.x=firstX,node.y=firstY,Laya.Tween.to(node,{x:targetX,y:targetY},time,null,Laya.Handler.create(this,function(){null!==func&&func()}),delayed)},Animation.deform_Move=function(node,firstX,targetX,scaleX,scaleY,time,delayed,func){node.x=firstX,Laya.Tween.to(node,{x:targetX,scaleX:scaleX,scaleY:scaleY},time,Laya.Ease.cubicOut,Laya.Handler.create(this,function(){Laya.Tween.to(node,{scaleX:1,scaleY:1},time,null,Laya.Handler.create(this,function(){null!==func&&func()}),0)}),delayed)},Animation.blink=function(node,minAlpha,maXalpha,time,delayed,func){node.alpha=minAlpha,Laya.Tween.to(node,{alpha:maXalpha},time,null,Laya.Handler.create(this,function(){Laya.Tween.to(node,{alpha:minAlpha},time,null,Laya.Handler.create(this,function(){null!==func&&func()}),0)}),delayed)}}(Animation||(Animation={}));class backGround extends Laya.Script{constructor(){super(),this.intType=1e3,this.numType=1e3,this.strType="hello laya",this.boolType=!0}onEnable(){this.self=this.owner,this.timer=0,this.selectSwitch=!0,this.blinkSwicth=!1,console.log("11");for(let index=0;index<this.self._children.length;index++){this.self._children[index].alpha=0}}onUpdate(){if(this.selectSwitch){this.selectSwitch=!1;let index=Math.floor(7*Math.random());Animation.blink(this.self._children[index],0,1,300,0,f=>{this.selectSwitch=!0})}}onDisable(){}}class Levels extends Laya.Script{constructor(){super()}onEnable(){this.self=this.owner,this.self.LevelsNode=this,this.gameControl=this.self.scene.GameControl}adaptive(){switch(this.Levels.value.length){case 1:this.guan.x=64;break;case 2:default:this.guan.x=72}}onDisable(){}}!function(Clicks){Clicks.clicksOn=function(effect,audioUrl,target,caller,down,move,up,out){let btnEffect;switch(Clicks.audioUrl=audioUrl,effect){case"largen":btnEffect=new Btn_LargenEffect;break;case"balloon":btnEffect=new Btn_Balloon;break;case"beetle":btnEffect=new Btn_Beetle;break;default:btnEffect=new Btn_LargenEffect}target.on(Laya.Event.MOUSE_DOWN,caller,null===down?btnEffect.down:down),target.on(Laya.Event.MOUSE_MOVE,caller,null===move?btnEffect.move:move),target.on(Laya.Event.MOUSE_UP,caller,null===up?btnEffect.up:up),target.on(Laya.Event.MOUSE_OUT,caller,null===out?btnEffect.out:out)},Clicks.clicksOff=function(effect,target,caller,down,move,up,out){let btnEffect;switch(effect){case"largen":btnEffect=new Btn_LargenEffect;break;case"balloon":btnEffect=new Btn_Balloon;break;case"beetle":btnEffect=new Btn_Beetle}target.off(Laya.Event.MOUSE_DOWN,caller,null===down?btnEffect.down:down),target.off(Laya.Event.MOUSE_MOVE,caller,null===move?btnEffect.move:move),target.off(Laya.Event.MOUSE_UP,caller,null===up?btnEffect.up:up),target.off(Laya.Event.MOUSE_OUT,caller,null===out?btnEffect.out:out)}}(Clicks||(Clicks={}));class Btn_LargenEffect{constructor(){}down(event){event.currentTarget.scale(1.1,1.1),Laya.SoundManager.playSound(Clicks.audioUrl,1,Laya.Handler.create(this,function(){}))}up(event){event.currentTarget.scale(1,1)}move(event){event.currentTarget.scale(1,1)}out(event){event.currentTarget.scale(1,1)}}class Btn_Balloon{constructor(){}down(event){event.currentTarget.scale(Clicks.balloonScale+.06,Clicks.balloonScale+.06),Laya.SoundManager.playSound(Clicks.audioUrl,1,Laya.Handler.create(this,function(){}))}up(event){event.currentTarget.scale(Clicks.balloonScale,Clicks.balloonScale)}move(event){event.currentTarget.scale(Clicks.balloonScale,Clicks.balloonScale)}out(event){event.currentTarget.scale(Clicks.balloonScale,Clicks.balloonScale)}}class Btn_Beetle{constructor(){}down(event){event.currentTarget.scale(Clicks.beetleScale+.06,Clicks.beetleScale+.06),Laya.SoundManager.playSound(Clicks.audioUrl,1,Laya.Handler.create(this,function(){}))}up(event){event.currentTarget.scale(Clicks.beetleScale,Clicks.beetleScale)}move(event){event.currentTarget.scale(Clicks.beetleScale,Clicks.beetleScale)}out(event){event.currentTarget.scale(Clicks.beetleScale,Clicks.beetleScale)}}class Props extends Laya.Script{constructor(){super()}onEnable(){this.self=this.owner,this.self.Props=this,this.gameControl=this.self.scene.GameControl,this.prop_skeleton=this.self.getChildByName("prop_skeleton"),this.beetleParent=this.gameControl.beetleParent,this.createBoneAni()}createBoneAni(){this.templet=new Laya.Templet,this.templet.on(Laya.Event.COMPLETE,this,this.parseComplete),this.templet.on(Laya.Event.ERROR,this,this.onError),this.templet.loadAni("Skeleton/trumpet.sk")}onError(){console.log("小喇叭骨骼动画加载错误！")}parseComplete(){console.log("小喇叭骨骼动画加载成功！"),this.playSkeletonAni(1,"static")}playSkeletonAni(speed,type){this.prop_skeleton.play(type,!0),this.prop_skeleton.rotation=0,this.prop_skeleton.playbackRate(speed)}eliminateBeetle(){if(0===this.beetleParent._children.length)console.log("没有小甲虫");else{let beetle=this.beetleParent._children[0];beetle.Beetle.playSkeletonAni(1,"death"),beetle.Beetle.clicksOffBtn(),Animation.drop(beetle,beetle.y+1600,0,1e3,0,f=>{beetle.removeSelf()})}}prorAttack(){let delay=0;for(let l=0;l<6;l++)delay+=75,Laya.timer.once(delay,this,function(){let bullet=Laya.Pool.getItemByCreateFun("bullet",this.bullet.create,this.bullet);this.self.addChild(bullet),bullet.x=25,bullet.y=60,bullet.Bullet.line=l,bullet.Bullet.moveSwitch=!0})}clicksOnBtn(){Clicks.clicksOn("largen","音效/按钮点击.mp3",this.self,this,null,null,this.up,null)}clicksOffBtn(){Clicks.clicksOff("largen",this.self,this,null,null,this.up,null)}up(event){event.currentTarget.scale(1,1);let number=Number(this.propNum.value.substring(1,3));console.log(number),number>0?(this.prop_skeleton.play("attack",!1),this.prop_skeleton.playbackRate(3),this.propNum.value="x"+(number-1).toString(),this.eliminateBeetle(),this.clicksOffBtn(),Animation.leftRight_Shake(this.gameControl.BalloonVessel,20,50,100,f=>{this.clicksOnBtn()}),this.prorAttack()):this.gameControl.createHint()}onDisable(){}}!function(WXDataManager){function authorizedWXLogin(){Laya.Browser.onMiniGame&&WXDataManager.wx.login({success:function(res){res.code&&console.log("登录成功，获取到code",res.code);var button=WXDataManager.wx.createUserInfoButton({type:"text",text:"开始游戏",style:{left:WXDataManager.wx.getSystemInfoSync().screenWidth/2-60,bottom:WXDataManager.wx.getSystemInfoSync().screenHeight/2-60,width:120,height:40,lineHeight:40,backgroundColor:"#fb94a9",color:"#ffffff",textAlign:"center",fontSize:16,borderRadius:20}});button.show(),button.onTap(res=>{console.log(res),"getUserInfo:ok"===res.errMsg?(console.log("已经授权"),button.destroy(),getUserinfo(null)):console.log("没有授权")})}})}function getUserinfo(type){Laya.Browser.onMiniGame?(WXDataManager.wx.cloud.init({env:"release-lwg"}),WXDataManager.wx.cloud.callFunction({name:"login"}).then(res=>{if(console.log("登录成功回调：",res),WXDataManager.WXopenid=res.result.openid,console.log("WXopenid为：",WXDataManager.WXopenid),WXDataManager.user_id=WXDataManager.WXopenid,"firstlogin"===type){try{add_GameData()}catch(error){console.log(error)}try{get_GameData()}catch(error){console.log(error)}}else if("haveLogin"===type)try{get_GameData()}catch(error){console.log(error)}})):console.log("获取玩家信息仅支持微信客户端")}function add_GameData(){if(Laya.Browser.onMiniGame){WXDataManager.wx.cloud.init({env:"release-lwg"});let db=WXDataManager.wx.cloud.database();db.collection("user_info").add({data:{_id:WXDataManager.user_id,gameData:WXDataManager._gameData,due:new Date("2018-09-01"),location:new db.Geo.Point(113,23),done:!1}}).then(res=>{console.log("没有登录过重新上传："+res)})}else console.log("添加信息仅支持微信客户端")}function get_GameData(){if(Laya.Browser.onMiniGame){WXDataManager.wx.cloud.init({env:"release-lwg"}),WXDataManager.wx.cloud.database().collection("user_info").doc(WXDataManager.user_id).get().then(res=>{console.log(res.data),WXDataManager._gameData=res.data.gameData,WXDataManager._gameData=res.data.gameData,console.log("上次的关卡数为："+WXDataManager._gameData._levels,"上次的道具数为："+WXDataManager._gameData._propNum)})}else console.log("获取信息仅支持微信客户端")}WXDataManager._gameData={_levels:1,_propNum:3},WXDataManager.wx=Laya.Browser.window.wx,WXDataManager.WXcheckSession=function(){Laya.Browser.onMiniGame&&WXDataManager.wx.checkSession({success(){console.log("已经登录过了！")},fail(){authorizedWXLogin(),console.log("重新登录")}})},WXDataManager.authorizedWXLogin=authorizedWXLogin,WXDataManager.normalWXLogin=function(){Laya.Browser.onMiniGame?WXDataManager.wx.checkSession({success(){console.log("已经登录过了！"),getUserinfo("haveLogin")},fail(){console.log("重新登录"),WXDataManager.wx.login({success(res){getUserinfo("firstlogin")},fail(){console.log("登录失败")}})}}):console.log("登陆仅支持微信客户端")},WXDataManager.getUserinfo=getUserinfo,WXDataManager.add_GameData=add_GameData,WXDataManager.get_GameData=get_GameData,WXDataManager.update_GameData=function(){Laya.Browser.onMiniGame?(WXDataManager.wx.cloud.init({env:"release-lwg"}),WXDataManager.wx.cloud.database().collection("user_info").doc(WXDataManager.user_id).update({data:{gameData:WXDataManager._gameData}}).then(res=>{console.log(res)})):console.log("上传信息仅支持微信客户端")},WXDataManager.wxPostInit=function(){Laya.Browser.onMiniGame&&Laya.loader.load(["res/atlas/rank.atlas"],Laya.Handler.create(null,function(){Laya.MiniAdpter.sendAtlasToOpenDataContext("res/atlas/rank.atlas"),Laya.Browser.window.wx.getOpenDataContext().postMessage({action:"init"})}))},WXDataManager.wxPostData=function(score){if(Laya.Browser.onMiniGame){let args={type:"scores",data:{scores:score}};Laya.Browser.window.wx.getOpenDataContext().postMessage(args),console.log("上传了")}else console.log("没有上传")},WXDataManager.wxShare=function(){Laya.Browser.onMiniGame?(Laya.Browser.window.wx.shareAppMessage({title:"你的手速够快吗？",imageUrlId:"CRYATpcgSFGkeB4Hs75jOQ",imageUrl:"https://mmocgame.qpic.cn/wechatgame/9zdKibmXJ3RsmFpXn6UAV4ScT8ulA4wzqUUNicKWDIaODZbuv38lkBBOBQv8XbxOI0/0"}),console.log("主动进行了转发")):console.log("仅支持微信客户端")}}(WXDataManager||(WXDataManager={})),function(SkTemplete){function onError_Balloon(){console.log("模板气球骨骼动画加载错误！")}function parseComplete_Balloon(){console.log("模板气球骨骼动画加载成功！")}SkTemplete.createBaoolonTemplet=function(){Laya.loader.load([{url:"Skeleton/balloon.png"},{url:"Skeleton/balloon.sk"}],Laya.Handler.create(this,function(){SkTemplete.baoolonTemplet=new Laya.Templet,SkTemplete.baoolonTemplet.on(Laya.Event.COMPLETE,this,parseComplete_Balloon),SkTemplete.baoolonTemplet.on(Laya.Event.ERROR,this,onError_Balloon),SkTemplete.baoolonTemplet.loadAni("Skeleton/balloon.sk")}))},SkTemplete.onError_Balloon=onError_Balloon,SkTemplete.parseComplete_Balloon=parseComplete_Balloon}(SkTemplete||(SkTemplete={})),function(Data){Data.dataLoading_Levels=function(){Laya.loader.load("Data/levelsData.json",Laya.Handler.create(this,this.onLoaded),null,Laya.Loader.JSON)},Data.onLoaded=function(){Data.levelsData=Laya.loader.getRes("Data/levelsData.json").RECORDS}}(Data||(Data={}));class GameControl extends Laya.Script{constructor(){super()}onEnable(){this.self=this.owner,this.self.GameControl=this,this.noStart(),this.createStartGame(),this.adaptive(),WXDataManager.wxPostInit(),SkTemplete.createBaoolonTemplet(),Data.dataLoading_Levels(),WXDataManager.normalWXLogin(),PalyAudio.playMusic(Enum.AudioName.bgm,0,1e3)}watchAdsFunc(type){"yes"===type?this.propNum.value=(Number(this.propNum.value)+1).toString():console.log("广告没有看完不给与奖励"),this.timeSwicth=!0}adaptive(){let stageH=Laya.stage.height;this.self.height=stageH,this.Background.height=stageH,this.Tip.y=.171*stageH,this.BalloonVessel.y=.266*stageH,this.BalloonVessel.height=.697*stageH;let parentBoard=this.BalloonVessel.getChildByName("parentBoard");parentBoard.height=.697*stageH,this.BalloonParent.height=parentBoard.height-100,this.Grass.y=stageH}levelsNodeAdaptive(){let guan=this.LevelsNode.getChildByName("guan");Number(this.Levels.value)>=10?(guan.x=72,this.Levels.x=68):(guan.x=64,this.Levels.x=70)}noStart(){this.Tip.alpha=0,this.BalloonVessel.alpha=0,this.Levels.value="1"}readyStart(type){"nextLevel"===type?this.Levels.value=(Number(this.Levels.value)+1).toString():"startGame"===type&&(this.Levels.value=WXDataManager._gameData._levels.toString(),this.propNum.value="x"+WXDataManager._gameData._propNum,this.openingAnimation()),this.time.value=1;let level=Number(this.Levels.value);switch(level>=40&&(level=40),this.row=Data.levelsData[level-1].row,this.line=Data.levelsData[level-1].line,this.colorCategory=Data.levelsData[level-1].colorCategory,this.beetleSpeed=Data.levelsData[level-1].beetleSpeed,this.timeVelocity=Data.levelsData[level-1].timeVelocity,this.line-this.row){case 0:this.spacing=5-.2*this.line;break;case 1:4===this.line&&3==this.row?this.spacing=27:this.spacing=26-3.1*(this.line-2)}this.levelsNodeAdaptive()}createStartGame(){let startGame=Laya.Pool.getItemByCreateFun("startGame",this.startGame.create,this.startGame);this.self.addChild(startGame)}openingAnimation(){this.Tip.alpha=1,this.BalloonVessel.alpha=1;this.Tip.getChildByName("plug_01").x=-1550,this.Tip.getChildByName("plug_02").x=-800;let parentBoard=this.BalloonVessel.getChildByName("parentBoard");Animation.bombs_Appear(parentBoard,0,1,1.05,0,300,100,250,"common",f=>{this.createBalloonCollection()});let tipboard=this.Tip.getChildByName("tipboard");Animation.bombs_Appear(tipboard,0,1,1.2,0,300,100,500,"common",null),Animation.bombs_Appear(this.TimeNode,0,1,1.2,0,300,100,750,"common",null),Animation.bombs_Appear(this.PropsNode,0,1,1.2,0,300,100,1e3,"common",null),Animation.bombs_Appear(this.LevelsNode,0,1,1.2,0,300,100,1250,"common",null)}taskTipShake(delayed){let plug_01=this.Tip.getChildByName("plug_01");Animation.deform_Move(plug_01,1550,555,.85,1.15,150,delayed,null);let plug_02=this.Tip.getChildByName("plug_02");Animation.deform_Move(plug_02,-800,171,.85,1.15,150,delayed,fun=>{Animation.leftRight_Shake(this.Tip,15,60,0,null),Animation.leftRight_Shake(this.PropsNode,15,60,100,null),Animation.leftRight_Shake(this.LevelsNode,15,60,100,null)})}leaveAnimation(){let parentBoard=this.BalloonVessel.getChildByName("parentBoard");Animation.bombs_Vanish(parentBoard,0,0,0,300,250,f=>{});let tipboard=this.Tip.getChildByName("tipboard");Animation.bombs_Vanish(tipboard,0,0,0,300,500,null),Animation.bombs_Vanish(this.TimeNode,0,0,0,300,500,null),Animation.bombs_Vanish(this.PropsNode,0,0,0,300,500,null),Animation.bombs_Vanish(this.LevelsNode,0,0,0,300,500,null),this.pligAni(750),this.createStartGame(),this.clearAllBallon("startGame")}pligAni(delayed){let plug_01=this.Tip.getChildByName("plug_01"),firstX_01=plug_01.x;Animation.deform_Move(plug_01,firstX_01,1550,.85,1.15,800,delayed,null);let plug_02=this.Tip.getChildByName("plug_02"),firstX_02=plug_02.x;Animation.deform_Move(plug_02,firstX_02,-800,.85,1.15,800,delayed,null)}createBalloonCollection(){let widthP=this.BalloonParent.width,heightP=this.BalloonParent.height,delayed=0;for(let i=0;i<this.row;i++)for(let j=0;j<this.line;j++){delayed+=50;let x=widthP/this.row*(i+1)-widthP/(2*this.row),y=heightP/this.line*(j+1)-heightP/(2*this.line),balloon=this.createBallon(x,y),scale=(widthP/this.row-2*this.spacing)/balloon.width;balloon.scale(scale,scale),Clicks.balloonScale=scale,balloon.pivotX=balloon.width/2,balloon.pivotY=balloon.height/2,Animation.bombs_Appear(balloon,0,scale,scale+.1,0,200,100,delayed,"balloon",f=>{this.explodeAni(this.BalloonVessel,balloon.x+(1-scale)*balloon.pivotX/2,balloon.y+(1-scale)*balloon.pivotY/2,"vanish",6,10),i===this.row-1&&j===this.line-1&&(this.createBeetle(),this.TaskBalloonParentSet(),this.taskTipShake(0))})}}moveToNextLevel(){this.pligAni(250),Animation.bombs_Vanish(this.LevelsNode,0,0,0,100,250,f=>{this.readyStart("nextLevel"),this.clearAllBallon("restartAndNextLevel"),Animation.bombs_Appear(this.LevelsNode,0,1,1.1,0,300,100,250,"common",f=>{})}),Animation.bombs_Vanish(this.TimeNode,0,0,0,300,500,f=>{this.time.value=1,Animation.bombs_Appear(this.TimeNode,0,1,1.1,0,300,100,250,"common",f=>{})})}againCurrentlevel(){this.pligAni(250),Animation.swell_shrink(this.LevelsNode,1,1.3,100,0,f=>{Animation.swell_shrink(this.LevelsNode,1,1.3,100,0,f=>{})}),Animation.bombs_Vanish(this.TimeNode,0,0,0,200,500,f=>{this.time.value=1,Animation.bombs_Appear(this.TimeNode,0,1,1.1,0,200,100,1250,"common",f=>{})}),this.clearAllBallon("restartAndNextLevel")}clearAllBallon(type){let delayed=0,len=this.BalloonParent._children.length;if(0!==len)for(let index=0;index<len;index++){const element=this.BalloonParent._children[index];Animation.bombs_Vanish(element,0,0,0,100,delayed,f=>{index===len-1&&(this.clearAllTaskBallon(type),this.BalloonParent.removeChildren(0,len-1)),this.explodeAni(this.BalloonVessel,element.x+(1-Clicks.balloonScale)*element.pivotX/2,element.y+(1-Clicks.balloonScale)*element.pivotY/2,"vanish",6,10)}),delayed+=60}else this.clearAllTaskBallon(type)}clearAllTaskBallon(type){let delayed=0,len=this.TaskBalloonParent._children.length;for(let index=0;index<len;index++){const element=this.TaskBalloonParent._children[index];Animation.bombs_Vanish(element,0,0,0,150,delayed,f=>{element.removeSelf(),index===len-1&&"restartAndNextLevel"===type&&this.createBalloonCollection()}),delayed+=100}}createBallon(x,y){let balloon=Laya.Pool.getItemByCreateFun("balloon",this.balloon.create,this.balloon);this.BalloonParent.addChild(balloon),balloon.pos(x,y);let random=Math.floor(Math.random()*this.colorCategory);return balloon.name=Enum.BalloonName[random],balloon.Balloon.skeletoninit(),balloon}TaskBalloonParentSet(){let arr1=[];for(let i=0;i<this.BalloonParent._children.length;i++){const balloon=this.BalloonParent._children[i];arr1.push(balloon.name)}let arr2=Array.from(new Set(arr1)),len=arr2.length,widthP=75*len;this.TaskBalloonParent.width=widthP;let delayed,heightP=this.TaskBalloonParent.height;for(let j=0;j<len;j++){delayed=50*j;let colorSkin,name=arr2[j],x=widthP/len*(j+1)-widthP/(2*len),y=heightP/2;colorSkin=0===j?Enum.IconSkin_02[Enum.BalloonName[name]]:Enum.IconSkin_01[Enum.BalloonName[name]];let ballon_Icon=this.createBallon_Icon(x,y,colorSkin,name);Animation.bombs_Appear(ballon_Icon,0,1,1.1,0,200,200,delayed,"common",f=>{j===len-1&&(this.PropsNode.Props.clicksOnBtn(),this.balloonCount(),this.balloonClickOrder(),this.clicksAllOn(),this.timeSwicth=!0)})}this.TaskBalloonParent.pivotX=this.TaskBalloonParent.width/2,this.TaskBalloonParent.x=375}balloonClickOrder(){for(let i=0;i<this.TaskBalloonParent._children.length;i++){const taskBallon=this.TaskBalloonParent._children[i],name=taskBallon.name;let img=taskBallon.Balloon_Icon.img;name===this.clickOrderArr[0]?(Animation.swell_shrink(taskBallon,1.1,1.3,50,0,f=>{}),img.skin=Enum.IconSkin_02[Enum.BalloonName[name]]):(taskBallon.scale(1,1),img.skin=Enum.IconSkin_01[Enum.BalloonName[name]])}}balloonCount(){this.clickOrderArr=[];for(let j=0;j<this.TaskBalloonParent._children.length;j++){let taskBallon=this.TaskBalloonParent._children[j],taskName=taskBallon.name;for(let i=0;i<this.BalloonParent._children.length;i++){let name=this.BalloonParent._children[i].name;if(taskName===name){let num=taskBallon.Balloon_Icon.num;num.value=(Number(num.value)+1).toString(),this.clickOrderArr.push(name)}}}}createBallon_Icon(x,y,colorSkin,name){let balloon_icon=Laya.Pool.getItemByCreateFun("balloon_icon",this.balloon_icon.create,this.balloon_icon);return this.TaskBalloonParent.addChild(balloon_icon),balloon_icon.pos(x,y),balloon_icon.Balloon_Icon.img.skin=colorSkin,balloon_icon.name=name,balloon_icon}clicksAllOn(){for(let index=0;index<this.BalloonParent._children.length;index++){this.BalloonParent._children[index].Balloon.balloonClicksOn()}}clicksAllOff(){for(let index=0;index<this.BalloonParent._children.length;index++){this.BalloonParent._children[index].Balloon.balloonClicksOff()}}createGameOver(type){let gameOver=Laya.Pool.getItemByCreateFun("gameOver",this.gameOver.create,this.gameOver);WXDataManager.wxPostData(this.Levels.value),"defeated"===type?WXDataManager._gameData._levels=Number(this.Levels.value):"victory"===type&&(WXDataManager._gameData._levels=Number(this.Levels.value)+1),WXDataManager._gameData._propNum=Number(this.propNum.value.substring(1,3)),WXDataManager.update_GameData(),this.clicksAllOff(),this.PropsNode.Props.clicksOffBtn(),this.timeSwicth=!1;let len=this.beetleParent._children.length;if(0===len)return this.self.addChild(gameOver),void gameOver.GameOver.gameOverType(type);for(let index=0;index<len;index++){const beetle=this.beetleParent._children[index];beetle.Beetle.moveSwitch=!1,beetle.Beetle.remainTime=-2e4,beetle.Beetle.clicksOffBtn(),"defeated"===type?(beetle.Beetle.playSkeletonAni(1,"move"),Animation.simple_Move(beetle,beetle.x,beetle.y,beetle.x,beetle.y-1400,2e3,0,f=>{beetle.removeSelf(),this.self.addChild(gameOver),gameOver.GameOver.gameOverType(type)})):"victory"===type&&(beetle.Beetle.playSkeletonAni(1,"death"),Animation.drop(beetle,beetle.y+1600,0,1e3,0,f=>{beetle.removeSelf(),this.self.addChild(gameOver),gameOver.GameOver.gameOverType(type)}))}}createRanking(){let ranking=Laya.Pool.getItemByCreateFun("ranking",this.ranking.create,this.ranking);this.self.addChild(ranking)}createHint(){let hint=Laya.Pool.getItemByCreateFun("hint",this.hint.create,this.hint);this.self.addChild(hint),this.timeSwicth=!1}createBeetle(){let beetle=Laya.Pool.getItemByCreateFun("beetle",this.beetle.create,this.beetle);this.beetleParent.addChild(beetle)}explodeAni(parent,x,y,type,number,zOrder){for(let i=0;i<number;i++){let explode=Laya.Pool.getItemByCreateFun("explode",this.explode.create,this.explode);parent.addChild(explode),explode.zOrder=zOrder,explode.pos(x,y),explode.Explode.type=type,explode.Explode.line=i,explode.Explode.initProperty(type)}}onUpdate(){this.timeSwicth&&(this.time.value>0?this.time.value-=this.timeVelocity:this.time.value<=0&&(Animation.leftRight_Shake(this.TimeNode,20,60,50,f=>{this.createGameOver("defeated")}),this.timeSwicth=!1))}onDisable(){}}class Balloon extends Laya.Script{constructor(){super()}onEnable(){this.self=this.owner,this.self.Balloon=this,this.gameControl=this.self.scene.GameControl}skeletoninit(){this.skeleton=SkTemplete.baoolonTemplet.buildArmature(0),this.skeleton.pos(150,160),this.skeleton.play(Enum.Sk_Ballon_Type.scale+"_"+this.self.name,!0),this.self.addChild(this.skeleton)}playSkeletonAni(type,loop,speed){this.skeleton.play(type+"_"+this.self.name,loop),this.skeleton.rotation=0,this.skeleton.playbackRate(speed)}clickRight(){this.self.removeSelf(),this.gameControl.clickOrderArr.length>0&&this.gameControl.clickOrderArr.shift(),this.gameControl.balloonClickOrder(),0===this.gameControl.clickOrderArr.length&&this.gameControl.createGameOver("victory")}clickError(){this.gameControl.createGameOver("defeated"),Animation.leftRight_Shake(this.self,20,20,50,f=>{let parentArr=this.self.parent._children;for(let index=0;index<parentArr.length;index++){const element=parentArr[index];element.Balloon.skeleton.play(Enum.Sk_Ballon_Type.error+"_"+element.name,!0)}this.playSkeletonAni(Enum.Sk_Ballon_Type.disdain,!0,1)})}balloonClicksOn(){Clicks.clicksOn("balloon","音效/按钮点击.mp3",this.self,this,null,null,this.up,null)}balloonClicksOff(){Clicks.clicksOff("balloon",this.self,this,null,null,this.up,null)}up(event){event.currentTarget.scale(Clicks.balloonScale,Clicks.balloonScale),this.self.name===this.gameControl.clickOrderArr[0]?(this.gameControl.explodeAni(this.gameControl.BalloonVessel,this.self.x+(1-Clicks.balloonScale)*this.self.pivotX/2,this.self.y+(1-Clicks.balloonScale)*this.self.pivotY/2,this.self.name,20,10),PalyAudio.playSound(Enum.AudioName.balloonRight,1),this.clickRight()):(this.clickError(),PalyAudio.playSound(Enum.AudioName.balloonError,1))}onDisable(){this.skeleton.removeSelf()}onUpdate(){}}class Balloon_Icon extends Laya.Script{constructor(){super()}onEnable(){this.self=this.owner,this.gameControl=this.self.scene.GameControl,this.self.Balloon_Icon=this}onDisable(){}onUpdate(){}}class Beetle extends Laya.Script{constructor(){super(),this.remainTime=0}onEnable(){this.self=this.owner,this.self.Beetle=this,this.gameControl=this.self.scene.GameControl,this.BalloonVessel=this.gameControl.BalloonVessel,this.skeleton=this.self.getChildByName("skeleton"),this.createBoneAni(),this.birthLocation(),this.speed=this.gameControl.beetleSpeed,this.clicksOnBtn()}birthLocation(){let direction=Math.floor(2*Math.random());this.self.x=1===direction?this.BalloonVessel.x+this.BalloonVessel.width/2+800:this.BalloonVessel.x+this.BalloonVessel.width/2-800,this.self.y=this.BalloonVessel.y+1*Math.random()*this.BalloonVessel.height}movePos(){this.moveX=this.BalloonVessel.x-this.BalloonVessel.width/2+50+(this.BalloonVessel.width-160)*(1*Math.random()),this.moveY=this.BalloonVessel.y+80+(this.BalloonVessel.height-160)*(1*Math.random())}createBoneAni(){this.templet=new Laya.Templet,this.templet.on(Laya.Event.COMPLETE,this,this.parseComplete),this.templet.on(Laya.Event.ERROR,this,this.onError),this.templet.loadAni("Skeleton/beetle_01.sk")}onError(){console.log("骨骼动画加载错误！")}parseComplete(){this.moveSwitch=!0,this.posSwitch=!0,this.playSkeletonAni(1,"move")}playSkeletonAni(speed,type){this.skeleton.play(type,!0),this.skeleton.rotation=0,this.skeleton.playbackRate(speed)}clicksOnBtn(){Clicks.beetleScale=this.self.scaleX,Clicks.clicksOn("beetle","音效/按钮点击.mp3",this.self,this,null,null,this.up,null)}clicksOffBtn(){Clicks.clicksOff("beetle",this.self,this,null,null,this.up,null)}up(event){PalyAudio.playSound(Enum.AudioName.beetle,1),this.clicksOffBtn(),event.currentTarget.scale(Clicks.beetleScale,Clicks.beetleScale);let parentArr=this.gameControl.BalloonParent._children;for(let index=0;index<parentArr.length;index++){const element=parentArr[index];element.Balloon.skeleton.play(Enum.Sk_Ballon_Type.disdain+"_"+element.name,!0)}Animation.leftRight_Shake(this.self,20,30,50,f=>{Animation.leftRight_Shake(this.self,20,30,50,f=>{this.gameControl.createGameOver("defeated")})})}moveRule(){let point=new Laya.Point(this.moveX-this.self.x,this.moveY-this.self.y);point.normalize(),this.self.x+=point.x*this.speed,this.self.y+=point.y*this.speed;let differenceX=Math.abs(this.self.x-this.moveX),differenceY=Math.abs(this.self.y-this.moveY);differenceX<30&&differenceY<30&&(this.playSkeletonAni(1,"stand"),this.moveSwitch=!1,this.remainTime=0)}onUpdate(){this.moveSwitch?this.posSwitch?(this.movePos(),this.playSkeletonAni(1,"move"),this.posSwitch=!1):this.moveRule():(this.remainTime++,this.remainTime>200&&(this.moveSwitch=!0,this.posSwitch=!0))}onDisable(){}}!function(Tools){function getDiffEle(arr,result,place){let indexArr=[],i=0;for(;i<arr.length-place;i++)indexArr.push(i);const ranIndex=Math.floor(Math.random()*indexArr.length);if(-1===result.indexOf(arr[ranIndex])){const backNum=arr[ranIndex];return arr[ranIndex]=arr[indexArr.length-1],backNum}return arr.splice(ranIndex,1),getDiffEle(arr,result,place)}Tools.random=function(n,m){const c=(m=m||10)-n+1;return Math.floor(Math.random()*c+n)},Tools.getRandomArrayElements=function(arr,count){for(var temp,index,shuffled=arr.slice(0),i=arr.length,min=i-count;i-- >min;)temp=shuffled[index=Math.floor((i+1)*Math.random())],shuffled[index]=shuffled[i],shuffled[i]=temp;return shuffled.slice(min)},Tools.getArrayDifElements=function(arr,count){const result=[];let i=0;for(;i<count;i++){const temp=getDiffEle(arr.slice(),result,i);result.push(temp)}return result},Tools.getDiffEle=getDiffEle,Tools.roleDragCan=!1,Tools.copydata=function(obj){const ret={};return Object.getOwnPropertyNames(obj).forEach(name=>{ret[name]=obj[name]}),ret},Tools.fillArray=function(value,len){for(var arr=[],i=0;i<len;i++)arr.push(value);return arr},Tools.speedByAngle=function(angle,XY){if(angle%90==0||!angle)return void console.error("计算的角度异常,需要查看：",angle);let speedXY={x:0,y:0};return speedXY.y=XY.y,speedXY.x=speedXY.y/Math.tan(angle*Math.PI/180),speedXY},Tools.speedXYByAngle=function(angle,speed){const speedXY={x:0,y:0};return speedXY.x=speed*Math.cos(angle*Math.PI/180),speedXY.y=speed*Math.sin(angle*Math.PI/180),speedXY},Tools.speedLabelByAngle=function(angle,speed,speedBate){const speedXY={x:0,y:0},selfAngle=angle,defaultSpeed=speed,bate=speedBate||1;if(selfAngle%90==0)0===selfAngle||360===selfAngle?speedXY.x=Math.abs(defaultSpeed)*bate:90===selfAngle?speedXY.y=Math.abs(defaultSpeed)*bate:180===selfAngle?speedXY.x=-Math.abs(defaultSpeed)*bate:speedXY.y=-Math.abs(defaultSpeed)*bate;else{const tempXY=Tools.speedXYByAngle(selfAngle,defaultSpeed);speedXY.x=tempXY.x,speedXY.y=tempXY.y,speedXY.y=selfAngle>0&&selfAngle<180?Math.abs(speedXY.y)*bate:-Math.abs(speedXY.y)*bate,speedXY.x=selfAngle>90&&selfAngle<270?-Math.abs(speedXY.x)*bate:Math.abs(speedXY.x)*bate}return speedXY},Tools.getRad=function(degree){return degree/180*Math.PI},Tools.getRoundPos=function(angle,radius,centPos){var center=centPos,hudu=(radius=radius,2*Math.PI/360*angle);return{x:center.x+Math.sin(hudu)*radius,y:center.y-Math.cos(hudu)*radius}},Tools.converteNum=function(num){if("number"!=typeof num)return console.warn("要转化的数字并不为number"),num;let backNum;return backNum=num<1e3?""+num:num<1e6?(num/1e3).toFixed(1)+"k":num<1e9?(num/1e6).toFixed(1)+"m":""+num}}(Tools||(Tools={}));class Bullet extends Laya.Script{constructor(){super()}onEnable(){this.self=this.owner,this.self.Bullet=this,this.gameControl=this.self.scene.GameControl,this.timer=0,this.self.alpha=1,this.initialAngle=145,this.accelerated=.1,this.baseSpeed=10,this.self.scale(.2,.2)}commonSpeedXYByAngle(angle,speed){this.self.x+=Tools.speedXYByAngle(angle,speed+this.accelerated).x,this.self.y+=Tools.speedXYByAngle(angle,speed+this.accelerated).y}move(){this.accelerated+=.01,this.timer>0&&this.timer<=8?this.commonSpeedXYByAngle(this.initialAngle,this.baseSpeed):this.timer>8&&(this.commonSpeedXYByAngle(this.initialAngle,this.baseSpeed-.2),this.self.alpha-=.1,this.self.alpha<=0&&(console.log("移除自身"),this.self.removeSelf())),this.self.scaleX+=.1,this.self.scaleY+=.1}onUpdate(){this.moveSwitch&&(this.timer+=1,this.move())}onDisable(){}}class Explode extends Laya.Script{constructor(){super()}onEnable(){this.timer=0,this.accelerated=.1,this.self=this.owner,this.img=this.self.getChildByName("img"),this.self.Explode=this,this.self.pivotX=this.self.width/2,this.self.pivotY=this.self.height/2}initProperty(type){this.effectsType=type,this.effectsType===Enum.BalloonName[0]||this.effectsType===Enum.BalloonName[1]||this.effectsType===Enum.BalloonName[2]||this.effectsType===Enum.BalloonName[3]?this.explosionBalloon_P():"vanish"===type&&this.vanish_P(),this.img.pivotX=this.img.width/2,this.img.pivotY=this.img.height/2}explosionBalloon_P(){this.moveSwitch=!0,this.randomSpeed=Math.floor(15*Math.random())+4,this.initialAngle=Math.floor(360*Math.random()),this.scale=Math.floor(8*Math.random())+4,this.self.scaleX=this.scale/10,this.self.scaleY=this.scale/10,this.vinshTime=Math.floor(5*Math.random())+2,this.startAlpha=1,this.self.alpha=this.startAlpha,this.rotationD=1===Math.floor(2*Math.random())?-10:10;let number=Math.floor(4*Math.random());switch(this.effectsType){case Enum.BalloonName[0]:this.img.skin=Enum.Explode_Yellowish[number];break;case Enum.BalloonName[1]:this.img.skin=Enum.Explode_Pink[number];break;case Enum.BalloonName[2]:this.img.skin=Enum.Explode_Yellow[number];break;case Enum.BalloonName[3]:this.img.skin=Enum.Explode_Cyan[number];break;case Enum.BalloonName[4]:this.img.skin=Enum.Explode_Purple[number]}}explosionBalloon_Move(){this.img.rotation+=this.rotationD,this.accelerated+=.1,this.timer>0&&this.timer<=15?this.commonSpeedXYByAngle(this.initialAngle,this.randomSpeed+5):this.timer>15&&this.timer<18?this.commonSpeedXYByAngle(this.initialAngle,this.randomSpeed-5):this.timer>=18&&this.self.removeSelf()}vanish_P(){this.moveSwitch=!0,this.randomSpeed=2*Math.random()+2,this.initialAngle=Math.floor(360*Math.random()),this.scale=7,this.self.scale(this.scale/10,this.scale/10),this.vinshTime=Math.floor(5*Math.random())+2,this.startAlpha=(Math.floor(6*Math.random())+4)/10,this.self.alpha=this.startAlpha,this.rotationD=1===Math.floor(2*Math.random())?-5:5,this.img.skin="特效/白色单元.png",this.img.rotation=this.initialAngle-90}vanish_Move(){this.accelerated+=.01,this.timer>0&&this.timer<=20?this.commonSpeedXYByAngle(this.initialAngle,this.randomSpeed):this.timer>20&&this.timer<30?this.commonSpeedXYByAngle(this.initialAngle,this.randomSpeed-3):this.timer>=30&&(this.self.alpha-=.02,this.self.alpha<=0&&this.self.removeSelf())}move(){this.effectsType===Enum.BalloonName[0]||this.effectsType===Enum.BalloonName[1]||this.effectsType===Enum.BalloonName[2]||this.effectsType===Enum.BalloonName[3]?this.explosionBalloon_Move():"vanish"===this.effectsType&&this.vanish_Move()}commonSpeedXYByAngle(angle,speed){this.self.x+=Tools.speedXYByAngle(angle,speed+this.accelerated).x,this.self.y+=Tools.speedXYByAngle(angle,speed+this.accelerated).y}onUpdate(){this.moveSwitch&&(this.timer+=1,this.move())}onDisable(){Laya.Pool.recover("explode",this.self)}}!function(Adaptive){Adaptive.interface_Center=function(self){self.width=750,self.pivotX=self.width/2,self.pivotY=self.height/2,self.pos(375,Laya.stage.height/2)},Adaptive.child_Center=function(child,parent,location){child.y=location-(Laya.stage.height/2-parent.height/2)},Adaptive.background_Center=function(background,parent){background.y=background.y-(Laya.stage.height/2-parent.height/2),background.width=Laya.stage.width,background.height=Laya.stage.height}}(Adaptive||(Adaptive={})),function(Advertising){Advertising.wx=Laya.Browser.window.wx,Advertising.videoAd_01_Lode=function(func_yes,func_no){Laya.Browser.onMiniGame&&(console.log("广告开始加载"),Advertising.videoAd_01=Advertising.wx.createRewardedVideoAd({adUnitId:"adunit-6de18c6de7b6d9ab"}),Advertising.videoAd_01.onLoad(()=>{console.log("激励视频 广告加载成功")}),Advertising.videoAd_01.onError(err=>{console.log(err)}),Advertising.videoAd_01.onClose(res=>{res&&res.isEnded||void 0===res?func_yes():(console.log("视频没有看望不会开始游戏"),func_no())}))},Advertising.bannerAd_01_Lode=function(){Laya.Browser.onMiniGame&&(console.log("广告开始加载"),Advertising.bannarAd_01=Advertising.wx.createBannerAd({adUnitId:"adunit-5329937f4349b0ea",adIntervals:30,style:{left:0,top:0,width:750}}),Advertising.bannarAd_01.onLoad(()=>{console.log("banner 广告加载成功")}),Advertising.bannarAd_01.onError(err=>{console.log(err)}))}}(Advertising||(Advertising={}));class GameOver extends Laya.Script{constructor(){super()}onEnable(){this.self=this.owner,this.self.GameOver=this,this.gameControl=this.self.scene.GameControl,this.Levels=this.gameControl.Levels,this.line=this.gameControl.line,this.logoSwitch=!1,this.logoChange="appear",Adaptive.interface_Center(this.self),Adaptive.background_Center(this.background,this.self)}gameOverType(type){"victory"===type?(this.btn_again.loadImage("UI/下一关按钮.png"),this.settlementType="victory",this.logo.loadImage("UI/闯关成功logo.png"),PalyAudio.playMusic(Enum.AudioName.victory,1,0)):"defeated"===type&&(this.btn_again.loadImage("UI/重来按钮.png"),this.settlementType="defeated",this.logo.loadImage("UI/闯关失败logo.png"),PalyAudio.playMusic(Enum.AudioName.defeated,1,0)),this.scoreNode.getChildByName("score").value=this.Levels.value,this.appaer()}appaer(){Animation.fade_out(this.background,0,.8,200,0,null),Animation.bombs_Appear(this.scoreNode,0,1,1.3,1===Math.floor(2*Math.random())?5:-5,250,60,0,"common",null),Animation.bombs_Appear(this.logo,0,1,1.3,1===Math.floor(2*Math.random())?5:-5,250,60,200,"common",null),Animation.bombs_Appear(this.btn_again,0,1,1.3,1===Math.floor(2*Math.random())?5:-5,250,60,400,"common",null),Animation.bombs_Appear(this.btn_return,0,1,1.3,1===Math.floor(2*Math.random())?5:-5,250,60,600,"common",func=>{this.appearFunc()})}appearFunc(){this.clicksOnBtn(),Laya.Browser.onMiniGame&&Advertising.bannarAd_01.show().then(()=>console.log("banner 广告显示"))}vanish(type){Animation.fade_out(this.background,.8,0,250,400,null),Animation.bombs_Vanish(this.scoreNode,0,0,1===Math.floor(2*Math.random())?5:-5,250,100,null),Animation.bombs_Vanish(this.logo,0,0,1===Math.floor(2*Math.random())?5:-5,250,200,null),Animation.bombs_Vanish(this.btn_again,0,0,1===Math.floor(2*Math.random())?5:-5,250,300,null),Animation.bombs_Vanish(this.btn_return,0,0,1===Math.floor(2*Math.random())?5:-5,250,400,f=>{this.vanishFunc(type)})}vanishFunc(type){Laya.Browser.onMiniGame&&Advertising.bannarAd_01.hide(),"return"===type?this.gameControl.leaveAnimation():"victory"===this.settlementType?this.gameControl.moveToNextLevel():"defeated"===this.settlementType&&this.gameControl.againCurrentlevel(),this.self.removeSelf(),PalyAudio.playMusic(Enum.AudioName.bgm,0,0)}clicksOnBtn(){Clicks.clicksOn("largen","音效/按钮点击.mp3",this.btn_again,this,null,null,this.up,null),Clicks.clicksOn("largen","音效/按钮点击.mp3",this.btn_return,this,null,null,this.up,null)}clicksOffBtn(){Clicks.clicksOff("largen",this.btn_again,this,null,null,this.up,null),Clicks.clicksOff("largen",this.btn_return,this,null,null,this.up,null)}up(event){event.currentTarget.scale(1,1),this.clicksOffBtn(),"btn_again"===event.currentTarget.name?this.vanish("again"):"btn_return"===event.currentTarget.name&&this.vanish("return")}onUpdate(){this.logoSwitch&&("appear"===this.logoChange?(this.logo.alpha-=.01,this.logo.alpha<.3&&(this.logoChange="vanish")):"vanish"===this.logoChange&&(this.logo.alpha+=.01,this.logo.alpha>=1&&(this.logoChange="appear")))}onDisable(){}}class Hint extends Laya.Script{constructor(){super()}onEnable(){this.self=this.owner,this.self.Hint=this,this.gameControl=this.self.scene.GameControl,Adaptive.interface_Center(this.self),Adaptive.background_Center(this.background,this.self),this.appaer()}appaer(){Animation.fade_out(this.background,0,.8,200,0,null),Animation.bombs_Appear(this.hintBox,0,1,1.1,1===Math.floor(2*Math.random())?5:-5,250,80,0,null),Animation.bombs_Appear(this.btn_not,0,1,1.3,1===Math.floor(2*Math.random())?5:-5,250,80,200,null),Animation.bombs_Appear(this.btn_watch,0,1,1.3,1===Math.floor(2*Math.random())?5:-5,250,80,400,f=>{this.appaerFunc()})}appaerFunc(){this.clicksOnBtn()}vanish(){Animation.fade_out(this.background,.8,0,250,600,null),Animation.bombs_Vanish(this.btn_watch,0,0,1===Math.floor(2*Math.random())?5:-5,250,150,null),Animation.bombs_Vanish(this.btn_not,0,0,1===Math.floor(2*Math.random())?5:-5,250,300,null),Animation.bombs_Vanish(this.hintBox,0,0,1===Math.floor(2*Math.random())?5:-5,250,450,f=>{this.vanishFunc()})}vanishFunc(){this.gameControl.timeSwicth=!0,this.self.removeSelf()}clicksOnBtn(){Clicks.clicksOn("largen","音效/按钮点击.mp3",this.btn_not,this,null,null,this.up,null),Clicks.clicksOn("largen","音效/按钮点击.mp3",this.btn_watch,this,null,null,this.up,null)}clicksOffBtn(){Clicks.clicksOff("largen",this.btn_not,this,null,null,this.up,null),Clicks.clicksOff("largen",this.btn_watch,this,null,null,this.up,null)}up(event){event.currentTarget.scale(1,1),"btn_watch"===event.currentTarget.name&&Laya.Browser.onMiniGame&&Advertising.videoAd_01.show().then(()=>console.log("banner 广告显示")),this.clicksOffBtn(),this.vanish()}onDisable(){}}class Ranking extends Laya.Script{constructor(){super()}onEnable(){this.self=this.owner,this.self.Ranking=this,this.gameControl=this.self.scene.GameControl,Adaptive.background_Center(this.background,this.self),Adaptive.interface_Center(this.self),this.appear()}onAwake(){if(console.log("排行榜"),Laya.Browser.onMiniGame){Laya.Browser.window.wx.getOpenDataContext().postMessage({action:"ranking"})}}appear(){Animation.fade_out(this.background,0,.3,300,0,null),Animation.fade_out(this.baseboard,0,1,300,0,func=>this.clicksOnBtn())}vanish(){Animation.fade_out(this.background,.3,0,300,0,func=>this.vanishFunc()),Animation.fade_out(this.baseboard,1,0,300,0,null)}vanishFunc(){if(this.self.removeSelf(),Laya.Browser.onMiniGame){Laya.Browser.window.wx.getOpenDataContext().postMessage({action:"close"})}}clicksOnBtn(){Clicks.clicksOn("largen","音效/按钮点击.mp3",this.background,this,null,null,this.up,null)}clicksOffBtn(){Clicks.clicksOff("largen",this.background,this,null,null,this.up,null)}up(event){event.currentTarget.scale(1,1),this.vanish(),console.log("我点击了背景！")}onDisable(){}}class StartGame extends Laya.Script{constructor(){super()}onEnable(){this.self=this.owner,this.self.GameOver=this,this.balloon_skeleton=this.balloon.getChildByName("balloon_skeleton"),this.gameControl=this.self.scene.GameControl,this.LevelsNode=this.gameControl.LevelsNode,this.gameControl.startNode=this.self,this.startSwitch=!1,this.startChange="appear",Adaptive.interface_Center(this.self),Adaptive.child_Center(this.anti_addiction,this.self,9*Laya.stage.height/10),this.timer=0,this.appaer(),this.createBoneAni()}createBoneAni(){this.templet=new Laya.Templet,this.templet.on(Laya.Event.COMPLETE,this,this.parseComplete),this.templet.on(Laya.Event.ERROR,this,this.onError),this.templet.loadAni("Skeleton/beetle_01.sk")}onError(){console.log("装饰气球加载错误！")}parseComplete(){this.balloon_skeleton.play("rock",!0),console.log("装饰气球加载成功！")}appaer(){for(let index=0;index<this.logo._children.length;index++){const element=this.logo._children[index];Animation.bombs_Appear(element,0,1,1.3,1===Math.floor(2*Math.random())?5:-5,250,100,300*index,"common",null)}Animation.bombs_Appear(this.btn_start,0,1,1.3,1===Math.floor(2*Math.random())?5:-5,250,100,1500,"common",null),Animation.bombs_Appear(this.btn_ranking,0,1,1.3,1===Math.floor(2*Math.random())?5:-5,250,100,1800,"common",null),Animation.bombs_Appear(this.btn_share,0,1,1.3,1===Math.floor(2*Math.random())?5:-5,250,100,2100,"common",f=>{this.appaerFunc()}),Animation.fade_out(this.anti_addiction,0,1,1e3,0,null)}appaerFunc(){this.startSwitch=!0,this.clicksOnBtn()}vanish(){for(let index=0;index<this.logo._children.length;index++){const element=this.logo._children[index];Animation.bombs_Vanish(element,0,0,1===Math.floor(2*Math.random())?5:-5,250,100*index,null)}Animation.bombs_Vanish(this.btn_start,0,0,1===Math.floor(2*Math.random())?5:-5,250,100,f=>{Laya.Tween.clearAll(this.btn_start),this.startSwitch=!1}),Animation.bombs_Vanish(this.btn_ranking,0,0,1===Math.floor(2*Math.random())?5:-5,250,200,null),Animation.bombs_Vanish(this.btn_share,0,0,1===Math.floor(2*Math.random())?5:-5,250,300,f=>{this.vanishFunc()}),Animation.fade_out(this.anti_addiction,1,0,1e3,0,null)}vanishFunc(){this.self.removeSelf(),this.gameControl.readyStart("startGame")}clicksOnBtn(){Clicks.clicksOn("largen","音效/按钮点击.mp3",this.btn_start,this,null,null,this.up,null),Clicks.clicksOn("largen","音效/按钮点击.mp3",this.btn_ranking,this,null,null,this.up,null),Clicks.clicksOn("largen","音效/按钮点击.mp3",this.btn_share,this,null,null,this.up,null)}clicksOffBtn(){Clicks.clicksOff("largen",this.btn_start,this,null,null,this.up,null),Clicks.clicksOff("largen",this.btn_ranking,this,null,null,this.up,null),Clicks.clicksOff("largen",this.btn_share,this,null,null,this.up,null)}up(event){event.currentTarget.scale(1,1),"btn_start"===event.currentTarget.name?(this.vanish(),this.clicksOffBtn()):"btn_ranking"===event.currentTarget.name?this.gameControl.createRanking():"btn_share"===event.currentTarget.name&&WXDataManager.wxShare()}onUpdate(){this.startSwitch&&("appear"===this.startChange?(this.btn_start.scaleX+=.003,this.btn_start.scaleY+=.003,this.btn_start.scaleX>1.05&&(this.startChange="vanish")):"vanish"===this.startChange&&(this.btn_start.scaleX-=.003,this.btn_start.scaleY-=.003,this.btn_start.scaleX<1&&(this.startChange="appear")))}onDisable(){}}class GameConfig{constructor(){}static init(){var reg=Laya.ClassUtils.regClass;reg("Script/Project/Background.ts",backGround),reg("Script/Project/LevelsNode.ts",Levels),reg("Script/Project/Props.ts",Props),reg("Script/Project/GameControl.ts",GameControl),reg("Script/Project/Balloon.ts",Balloon),reg("Script/Project/Balloon_Icon.ts",Balloon_Icon),reg("Script/Project/Beetle.ts",Beetle),reg("Script/Project/Bullet.ts",Bullet),reg("Script/Project/Explode.ts",Explode),reg("Script/Project/GameOver.ts",GameOver),reg("Script/Project/Hint.ts",Hint),reg("Script/Project/Ranking.ts",Ranking),reg("Script/Project/StartGame.ts",StartGame)}}GameConfig.width=750,GameConfig.height=1334,GameConfig.scaleMode="fixedwidth",GameConfig.screenMode="none",GameConfig.alignV="top",GameConfig.alignH="left",GameConfig.startScene="Scenes/MainScene.scene",GameConfig.sceneRoot="",GameConfig.debug=!1,GameConfig.stat=!1,GameConfig.physicsDebug=!1,GameConfig.exportSceneToJson=!0,GameConfig.init();new class{constructor(){window.Laya3D?Laya3D.init(GameConfig.width,GameConfig.height):Laya.init(GameConfig.width,GameConfig.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=GameConfig.scaleMode,Laya.stage.screenMode=GameConfig.screenMode,Laya.stage.alignV=GameConfig.alignV,Laya.stage.alignH=GameConfig.alignH,Laya.URL.exportSceneToJson=GameConfig.exportSceneToJson,(GameConfig.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),GameConfig.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),GameConfig.stat&&Laya.Stat.show(),Laya.alertGlobalError=!0,Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}onVersionLoaded(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}onConfigLoaded(){GameConfig.startScene&&Laya.Scene.open(GameConfig.startScene)}}}();